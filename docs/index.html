<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RFC XXXX - Key-Value String Parser Specification</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-funky.min.css" rel="stylesheet" />
    <style>
        body {
            background-color: #000;
            color: #c0c0c0;
            font-family: 'Courier New', monospace;
            line-height: 1.4;
            max-width: 72ch;
            margin: 0 auto;
            padding: 1rem;
            font-size: 16px;
        }
        
        .rfc-header {
            border-bottom: 1px solid #808080;
            padding-bottom: 1rem;
            margin-bottom: 1rem;
        }
        
        .rfc-title {
            text-align: center;
            margin: 1rem 0;
            font-weight: bold;
        }
        
        .rfc-meta {
            display: flex;
            justify-content: space-between;
            margin: 0.2rem 0;
            font-size: 14px;
        }
        
        .rfc-meta a {
            color: #00ffff;
            text-decoration: underline;
        }
        
        .rfc-meta a:hover {
            color: #ffffff;
        }
        
        .links {
            text-align: center;
            margin: 0.5rem 0;
            font-size: 14px;
        }
        
        .links a {
            color: #00ffff;
            text-decoration: underline;
            margin: 0 0.5rem;
        }
        
        .links a:hover {
            color: #ffffff;
        }
        
        h1, h2, h3 {
            color: #ffffff;
            margin-top: 1.5rem;
            margin-bottom: 0.5rem;
            font-weight: bold;
        }
        
        h1 {
            font-size: 20px;
            text-transform: uppercase;
        }
        
        h2 {
            font-size: 18px;
        }
        
        h3 {
            font-size: 16px;
        }
        
        .section-number {
            color: #808080;
        }
        
        pre, code {
            background-color: #111111;
            padding: 0.5rem;
            overflow-x: auto;
            color: #c0c0c0;
            font-size: 15px;
        }
        
        code {
            padding: 0.1rem 0.2rem;
            display: inline;
        }
        
        /* Override Prism theme for our dark style */
        pre[class*="language-"] {
            background-color: #000000 !important;
            border: 1px solid #808080;
        }
        
        /* Prevent unwanted highlighting on regular text */
        body p, body li, body h1, body h2, body h3, body span:not([class*="token"]) {
            color: #c0c0c0 !important;
            background: transparent !important;
        }
        
        /* Ensure section numbers and links maintain their colors */
        .section-number {
            color: #808080 !important;
        }
        
        .rfc-meta a, .links a {
            color: #00ffff !important;
        }
        
        h1, h2, h3 {
            color: #ffffff !important;
        }
        
        .demo-container {
            background-color: #111111;
            border: 2px solid #808080;
            padding: 1rem;
            margin: 1rem 0;
        }
        
        .demo-grid {
            display: grid;
            grid-template-columns: 1fr auto 1fr;
            gap: 0.5rem;
            align-items: start;
        }
        
        .demo-controls {
            display: flex;
            flex-direction: column;
            gap: 0.2rem;
            justify-self: center;
            align-self: center;
        }
        
        .demo-input, .demo-output {
            width: 100%;
            min-height: 150px;
            background-color: #000000;
            color: #00ff00;
            border: 1px solid #808080;
            padding: 0.5rem;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            resize: vertical;
        }
        
        .demo-button {
            background-color: #808080;
            color: #000000;
            border: 2px outset #808080;
            padding: 0.3rem 0.8rem;
            cursor: pointer;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            font-weight: bold;
        }
        
        .demo-button:hover {
            background-color: #a0a0a0;
        }
        
        .demo-button:active {
            border: 2px inset #808080;
            background-color: #606060;
        }
        
        .abstract {
            background-color: #111111;
            border: 1px solid #808080;
            padding: 0.8rem;
            margin: 1rem 0;
            font-style: normal;
        }
        
        .status {
            color: #808080;
            font-size: 13px;
            text-align: center;
            margin: 0.5rem 0;
        }
        
        ul {
            margin: 0.5rem 0;
            padding-left: 2rem;
        }
        
        li {
            margin: 0.2rem 0;
        }
        
        @media (max-width: 768px) {
            .demo-grid {
                grid-template-columns: 1fr;
                grid-template-rows: auto auto auto;
            }
            
            .demo-controls {
                order: 2;
                flex-direction: row;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="rfc-header">
        <div class="rfc-meta">
            <span></span>
            <span><a href="https://github.com/fedemartinm" target="_blank">fedemartinm</a></span>
        </div>
        <div class="rfc-meta">
            <span></span>
            <span>June 2025</span>
        </div>
        <div class="rfc-meta">
            <span></span>
            <span>Version: 1.0.0</span>
        </div>
        
        <h1 class="rfc-title">Key-Value String Parser Specification</h1>
        
        <div class="links">
            <a href="https://www.npmjs.com/package/key-value-string" target="_blank">[NPM Package]</a>
            <a href="https://github.com/fedemartinm/key-value-string" target="_blank">[GitHub Repository]</a>
        </div>
    </div>

    <div class="abstract">
        <strong>Abstract</strong><br><br>
        This document specifies a simple key-value string format and parsing algorithm for configuration files, 
        URL parameters, and structured data exchange. The format supports strings, numbers, arrays, and null values 
        with a zero-dependency implementation thoroughly tested with 200+ unit tests.
    </div>

    <h2><span class="section-number">1.</span> Introduction</h2>
    <p>
        The Key-Value String format provides a human-readable and machine-parseable way to represent 
        structured data. It is particularly useful for configuration files, command-line parameters, 
        and data exchange where JSON might be too verbose or complex.
    </p>

    <h2><span class="section-number">2.</span> Interactive Demo</h2>
    <div class="demo-container">
        <h3>Try it out:</h3>
        <div class="demo-grid">
            <div>
                <label for="kvs-input">Key-Value String:</label>
                <textarea id="kvs-input" class="demo-input" placeholder="name=John;age=30;tags=frontend,backend;">name=John Doe;age=30;active=true;tags=frontend,backend,javascript;score=95.5;</textarea>
            </div>
            
            <div class="demo-controls">
                <button class="demo-button" onclick="parseToJSON()">Parse --></button>
                <button class="demo-button" onclick="stringifyToKVS()"><-- Stringify</button>
            </div>
            
            <div>
                <label for="json-output">JSON Output:</label>
                <textarea id="json-output" class="demo-output" readonly></textarea>
            </div>
        </div>
    </div>

    <h2><span class="section-number">3.</span> Syntax Specification</h2>
    <h3><span class="section-number">3.1.</span> Basic Format</h3>
    <p>A key-value string consists of pairs separated by semicolons:</p>
    <pre><code class="language-bash">key1=value1;key2=value2;key3=value3;</code></pre>

    <h3><span class="section-number">3.2.</span> Data Types</h3>
    <p>The parser supports the following data types:</p>
    <ul>
        <li><strong>Strings:</strong> Unquoted or quoted with double quotes</li>
        <li><strong>Numbers:</strong> Integers and floating-point numbers</li>
        <li><strong>Arrays:</strong> Comma-separated values</li>
        <li><strong>Null:</strong> Empty values</li>
    </ul>

    <h3><span class="section-number">3.3.</span> Examples</h3>
    <pre><code class="language-bash"># String values
name=John;
title="Senior Developer";

# Numeric values  
age=30;
salary=75000.50;

# Arrays
tags=frontend,backend,javascript;
scores=95,87,92;

# Null values
optional=;

# Mixed array with null
items=apple,,orange;  # Results in ["apple", null, "orange"]</code></pre>

    <h2><span class="section-number">4.</span> Implementation</h2>
    <h3><span class="section-number">4.1.</span> Installation</h3>
    <pre><code class="language-bash">npm install key-value-string</code></pre>

    <h3><span class="section-number">4.2.</span> Usage Examples</h3>
    <pre><code class="language-javascript">// Node.js (CommonJS)
const { parseKeyValueString, toKeyValueString } = require('key-value-string');

// Parse key-value string
const result = parseKeyValueString('name=John;age=30;tags=frontend,backend;');
console.log(result);
// Output: { name: 'John', age: 30, tags: ['frontend', 'backend'] }

// Convert object to key-value string
const kvString = toKeyValueString({ name: 'John', age: 30, active: true });
console.log(kvString);
// Output: name=John;age=30;active=true;</code></pre>

    <h3><span class="section-number">4.3.</span> Command Line Interface</h3>
    <pre><code class="language-bash"># Parse key-value string to JSON
kvs parse "name=John;age=30;tags=frontend,backend;"

# Convert JSON to key-value string  
kvs stringify '{"name":"John","age":30}'

# Validate syntax
kvs validate "name=John;age=30;"</code></pre>

    <h2><span class="section-number">5.</span> Browser Support</h2>
    <p>Multiple build formats are provided for different environments:</p>
    <ul>
        <li><strong>UMD:</strong> Universal module for older browsers (ES2015+)</li>
        <li><strong>ESM:</strong> ES Modules for modern browsers (ES2020+)</li>
        <li><strong>CommonJS:</strong> Node.js environments (v14+)</li>
    </ul>

    <h2><span class="section-number">6.</span> Security Considerations</h2>
    <p>
        This parser does not execute code and only processes data. However, applications should 
        validate parsed values before use, especially when processing untrusted input.
    </p>

    <h2><span class="section-number">7.</span> References</h2>
    <ul>
        <li>RFC 3986 - Uniform Resource Identifier (URI): Generic Syntax</li>
        <li>RFC 8259 - The JavaScript Object Notation (JSON) Data Interchange Format</li>
    </ul>

    <p style="margin-top: 2rem; padding-top: 1rem; border-top: 1px solid #808080; text-align: center; color: #808080; font-size: 14px;">
        Built with love and way too much coffee in a single night of pure vibecoding.
    </p>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script>
        // Inline parser implementation for demo (simplified version)
        function parseKeyValueString(input) {
            const result = {};
            const pairs = input.split(';').filter(pair => pair.trim());
            
            pairs.forEach(pair => {
                const [key, ...valueParts] = pair.split('=');
                const value = valueParts.join('=');
                
                if (!key.trim()) return;
                
                let parsedValue;
                if (value === '' || value === undefined) {
                    parsedValue = null;
                } else if (value.includes(',')) {
                    // Array handling
                    parsedValue = value.split(',').map(item => {
                        if (item === '') return null;
                        if (item.startsWith('"') && item.endsWith('"')) {
                            return item.slice(1, -1);
                        }
                        const num = parseFloat(item);
                        return !isNaN(num) && isFinite(num) ? num : item;
                    });
                } else {
                    // Single value
                    if (value.startsWith('"') && value.endsWith('"')) {
                        parsedValue = value.slice(1, -1);
                    } else {
                        const num = parseFloat(value);
                        parsedValue = !isNaN(num) && isFinite(num) ? num : value;
                    }
                }
                
                result[key.trim()] = parsedValue;
            });
            
            return result;
        }
        
        function toKeyValueString(obj) {
            const pairs = [];
            
            for (const [key, value] of Object.entries(obj)) {
                if (value === null || value === undefined) {
                    pairs.push(`${key}=;`);
                } else if (Array.isArray(value)) {
                    const valueStr = value.map(v => formatValue(v)).join(',');
                    pairs.push(`${key}=${valueStr};`);
                } else {
                    pairs.push(`${key}=${formatValue(value)};`);
                }
            }
            
            return pairs.join('');
        }
        
        function formatValue(value) {
            if (value === null || value === undefined) {
                return '';
            }
            
            if (typeof value === 'number') {
                return value.toString();
            }
            
            const str = String(value);
            
            if (/[=,;"\s]/.test(str) || str === '') {
                return `"${str}"`;
            }
            
            return str;
        }
        
        function parseToJSON() {
            const input = document.getElementById('kvs-input').value;
            const output = document.getElementById('json-output');
            
            try {
                const result = parseKeyValueString(input);
                output.value = JSON.stringify(result, null, 2);
                output.style.color = '#00ff00';
            } catch (error) {
                output.value = `Error: ${error.message}`;
                output.style.color = '#ff0000';
            }
        }
        
        function stringifyToKVS() {
            const output = document.getElementById('json-output').value;
            const input = document.getElementById('kvs-input');
            
            try {
                const obj = JSON.parse(output);
                input.value = toKeyValueString(obj);
                input.style.color = '#00ff00';
            } catch (error) {
                input.value = `Error: ${error.message}`;
                input.style.color = '#ff0000';
            }
        }
        
        // Initialize demo on page load
        document.addEventListener('DOMContentLoaded', function() {
            parseToJSON();
        });
    </script>
</body>
</html> 